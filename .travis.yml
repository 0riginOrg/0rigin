matrix:
  include:
  - name: "origin-contracts / origin-js / origin-dapp unit tests"
    language: node_js
    node_js: 10
    before_install:
      - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then export CXX=g++-6; fi
    before_script:
    - npm install
    script:
    - npm test
    addons:
      apt:
        sources:
          - ubuntu-toolchain-r-test
        packages:
          - g++-6

  - name: "Origin-discovery unit tests"
    language: node_js
    node_js: 10
    addons:
      postgresql: 9.6
    services:
    - postgresql
    env:
    - DATABASE_URL=postgres://postgres@localhost/travis_ci_test
    before_script:
    - psql -c 'create database travis_ci_test;' -U postgres
    - cd origin-discovery
    - npm install
    - npm run migrate
    script:
    - npm test

  - name: "Bridge server unit tests"
    language: python
    python: 3.6
    before_script:
    - cd origin-bridge
    - pip install -r requirements.txt
    script:
    - pytest --flakes --codestyle
