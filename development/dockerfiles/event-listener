FROM node:10

WORKDIR /app

COPY package*.json ./
COPY lerna.json ./
COPY ./origin-js ./origin-js
COPY ./origin-contracts ./origin-contracts
COPY ./origin-discovery ./origin-discovery
COPY ./scripts ./scripts
RUN npm install --loglevel notice --unsafe-perm
# Build origin-js
RUN npm run build

WORKDIR /app/origin-discovery

CMD npm run migrate && npm run start:listener
